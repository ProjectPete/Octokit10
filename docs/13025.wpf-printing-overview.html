<html !DOCTYPE html>

<head>
    <script type='text/javascript' src='https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.5.2.min.js'></script>
    <link rel='stylesheet' type='text/css' href='include/LayoutMisc.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle2.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle3.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/DynamicStyle.css' xmlns='http://www.w3.org/1999/xhtml'>
</head>

<body style='margin:20px !important;'>

    <div id='theHeader'></div>

    <div id='theBreadcrumb'>
        <div class='breadcrumb-list'>
    <span class='breadcrumb-item'><a class='internal-link view-home' href='https://github.com/ProjectPete/Octokit10/tree/master/docs'>Wiki</a></span>

    <span class='separator'><span style='display:none;'></span>&nbsp;&gt;&nbsp;</span>
    <span class='breadcrumb-item'>
        <a href='/Octokit10/PageIndex1.html'>TechNet Articles</a>
    </span>

    <span class='breadcrumb-item'>
        <span class='separator'><span style='display:none;'></span>&nbsp;&gt;&nbsp;</span>
        <span class='breadcrumb-item'>
            <a href='https://github.com/ProjectPete/Octokit10/tree/master/docs/13025.wpf-printing-overview.html' class='last'>WPF Printing Overview - TechNet Articles - United States (English) - TechNet Wiki</a>
        </span>
    </span>
</div>

    </div>

    <div id='theOther'>
        
    </div>

    <h1 class='post-name'></h1>
            
    <!-- AUTO ADDED ABOVE -->

    <div class="post-content user-defined-markup"><div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Introduction">Introduction</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Using_DrawingContext">1. Using DrawingContext</a></li><li class="hierarchy-item"><a href="#Printing_WPF_Controls">2. Printing WPF Controls</a></li><li class="hierarchy-item"><a href="#Printing_Flow_Documents">3. Printing Flow Documents</a></li><li class="hierarchy-item"><a href="#Making_and_Printing_XPS_Documents">4. Making and Printing XPS Documents</a></li><li class="hierarchy-item"><a href="#Capturing_and_Saving_Video_Stills">5. Capturing and Saving Video Stills</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Landscape_Printing">6. Landscape Printing</a></li></ul><div class="hierarchy-list-footer"> </div></div>
<p><a name="Introduction"></a>&nbsp;</p>
<h2><a name="Introduction"></a><strong>Introduction</strong></h2>
<div><span style="font-size:13px;"><strong><span style="font-size:13px;"><br />
<span style="color:#ff0000;font-size:13px;">The techniques covered here are all available in a downloadable project over at MSDN Samples:</span></span></strong></span></div>
<span style="color:#ff0000;font-size:13px;">
<strong><span style="font-size:13px;">
</span></strong>
</span>
<div><span style="font-size:13px;"><a href="http://code.msdn.microsoft.com/WPF-Printing-Overview-f28c541a"><strong>http://code.msdn.microsoft.com/WPF-Printing-Overview-f28c541a</strong></a></span></div>
<div><br />
<div><strong><em>This sample shows five aspects of printing, in relation to WPF. <br />
With WPF, it has never been so easy to print your entire application, or build and format pages for printing.</em></strong></div>
</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<h3><a name="Using_DrawingContext"></a><strong>1. Using DrawingContext</strong></h3>
<div><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4606.printing1.png"><img alt=" " style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4606.printing1.png" /></a><br />
<br />
The<strong><a href="http://msdn.microsoft.com/en-us/library/system.windows.media.drawingcontext.aspx"> DrawingContext</a></strong> (of a <a href="http://msdn.microsoft.com/en-us/library/system.windows.media.drawingvisual.aspx">DrawingVisual</a>) allows you to build up the print page, like a canvas. <br />
<br />
This method allows you to build up the page in code with many methods, like&nbsp;adding shapes, images and text.<br />
<br />
In the accompanying MSDN sample, we test the following:<br />
<ul>
    <li><span style="font-family:arial;"><a href="http://msdn.microsoft.com/en-us/library/ms606813">DrawRoundedRectangle</a></span></li>
    <li><span style="font-family:arial;"><a href="http://msdn.microsoft.com/en-us/library/ms606804">DrawImage</a></span></li>
    <li><span style="font-family:arial;"><a>DrawText</a></span></li>
    <li><span style="font-family:arial;"><a href="http://msdn.microsoft.com/en-us/library/system.windows.media.drawingcontext.drawgeometry">DrawGeometry</a></span></li>
    <li><span style="font-family:arial;"><a href="http://msdn.microsoft.com/en-us/library/ms606797">DrawEllipse</a></span></li>
    <li><span style="font-family:arial;"><a href="http://msdn.microsoft.com/en-us/library/ms606813">DrawRectangle</a></span></li>
    <li><span style="font-family:arial;"><a href="http://msdn.microsoft.com/en-us/library/ms606808">DrawLine</a></span></li>
    <li><span style="font-family:arial;"><a href="http://msdn.microsoft.com/en-us/library/system.windows.media.drawingcontext.drawdrawing">DrawDrawing</a></span></li>
    <li><span style="font-family:arial;"></span><a href="http://msdn.microsoft.com/en-us/library/system.windows.media.drawingcontext.drawglyphrun"><span style="font-family:arial;">DrawGlyphRun</span></a></li>
</ul>
</div>
<div><br />
Below is a snippet from the project:<br />
&nbsp;
<div class="scriptcode">
<div class="pluginEditHolder">
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">DrawingVisual dv = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">DrawingVisual();</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">var dc = dv.RenderOpen();</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">var rect = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">Rect(</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">System.Windows.Point(20, 20), </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">System.Windows.Size(350, 240));</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">dc.DrawRoundedRectangle(System.Windows.Media.Brushes.Yellow, </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">Pen(Brushes.Purple, 2), rect, 20, 20); </code></span></div>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;<br />
<br />
</div>
</div>
<h3><a name="Printing_WPF_Controls"></a><strong>2. Printing WPF Controls</strong></h3>
<div><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4645.printing2.png"><img alt=" " style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4645.printing2.png" /></a><br />
<br />
WPF is specially good at printing, because you can print the rendered WPF controls, exactly as they are. <br />
<br />
You can also save to file or apply the image to another surface (technique sometimes used in reflections)<br />
<br />
In the example (shown above) there is a rotating <a href="http://msdn.microsoft.com/en-us/library/system.windows.controls.viewport3d.aspx">Viewport3D</a>, an Image and a TextBox for you to play with. Whatever state the controls are in, they will be printed.<br />
<br />
This method uses <a href="http://msdn.microsoft.com/en-us/library/system.windows.controls.printdialog.printvisual.aspx"><strong>PrintVisual</strong></a>, which takes any <a href="http://msdn.microsoft.com/en-us/library/system.windows.media.visual.aspx"><strong>Visual</strong></a> as it&#39;s parameter<br />
<br />
</div>
<div></div>
<div>
<div class="scriptcode">
<div class="pluginEditHolder">
<pre class="hidden"><div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;"><div style="background-color:#ffffff;"><span><code style="color:#000000;">PrintDialog dialog = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">PrintDialog();</code></span></div><div style="background-color:#f8f8f8;"><span>&nbsp;</span></div><div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">if</code> <code style="color:#000000;">(dialog.ShowDialog() != </code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">) </code><code style="color:#006699;font-weight:bold;">return</code><code style="color:#000000;">;</code></span></div><div style="background-color:#f8f8f8;"><span>&nbsp;</span></div><div style="background-color:#ffffff;"><span><code style="color:#000000;">printGrid.Measure(</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">Size(dialog.PrintableAreaWidth, dialog.PrintableAreaHeight));</code></span></div><div style="background-color:#f8f8f8;"><span><code style="color:#000000;">printGrid.Arrange(</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">Rect(</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">Point(50, 50), printGrid.DesiredSize));</code></span></div><div style="background-color:#ffffff;"><span>&nbsp;</span></div><div style="background-color:#f8f8f8;"><span><code style="color:#000000;">dialog.PrintVisual(printGrid, </code><code style="color:blue;">&quot;A WPF printing&quot;</code><code style="color:#000000;">); </code></span></div></div>&nbsp;</pre>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
</div>
<h3><a name="Printing_Flow_Documents"></a><strong>3. Printing Flow Documents</strong></h3>
<div><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2022.printing3.png"><img alt=" " style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2022.printing3.png" /></a><br />
<br />
Flow documents are a great way to display formatted content, and they are easy to print. <br />
<br />
The FlowDocumentReader is a rich user control, and printing pages can be controlled with the DocumentPaginator.<br />
<br />
In this example, you can resize the window or change the layout style. If there is more than one page whenyou print, they will print on separate pages.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">PrintDialog printDialog = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">PrintDialog();</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">if</code> <code style="color:#000000;">(printDialog.ShowDialog() == </code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">)</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">printDialog.PrintDocument(((IDocumentPaginatorSource)flowDocument).DocumentPaginator, </code><code style="color:blue;">&quot;This is a Flow Document&quot;</code><code style="color:#000000;">); </code></span></span></div>
</div>
</div>
<p>&nbsp;</p>
<h3><a name="Making_and_Printing_XPS_Documents"></a><strong>4. Making and Printing XPS Documents</strong></h3>
<div><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8306.printing4.png"><img alt=" " style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/8306.printing4.png" /></a><br />
<br />
<strong><a href="http://msdn.microsoft.com/en-us/magazine/cc163664.aspx">XPS documents</a></strong> are a popular printing file format, and they are easy to make out of WPF controls. <br />
<br />
Here we have an InkCanvas which you can draw on, enlarge the window, draw more and print.<br />
<br />
This example shows how to use the XpsDocumentWriter to build the file.<br />
<br />
The XPS file is then sent to the printer jobs queue.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">FixedDocument doc = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">FixedDocument();</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">PageContent pageContent = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">PageContent();</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">((System.Windows.Markup.IAddChild)pageContent).AddChild(page); </code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">doc.Pages.Add(pageContent);&nbsp; </code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">XpsDocument xpsd = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">XpsDocument(filename, FileAccess.Write);</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">XpsDocument.CreateXpsDocumentWriter(xpsd).Write(doc);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">xpsd.Close();</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">PrintDialog printDialog = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">PrintDialog();</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">if</code> <code style="color:#000000;">(printDialog.ShowDialog() == </code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">)</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">printDialog.PrintQueue.AddJob(</code><code style="color:blue;">&quot;MyInkCanvas print job&quot;</code><code style="color:#000000;">, filename, </code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">); </code></span></span></div>
</div>
</div>
<p>&nbsp;<br />
<br />
</p>
<h3><a name="Capturing_and_Saving_Video_Stills"></a><strong>5. Capturing and Saving Video Stills</strong></h3>
<div><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4578.printing5.png"><img alt=" " style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4578.printing5.png" /></a><br />
<br />
This example shows how you can &quot;scrub&quot; through a video and pull out frames to file and printer. <br />
<br />
A slider bar is joined to the MediaElement to allow scene selection.<br />
<br />
When you click print, the selected video frame is converted into a Jpeg, saved and printed.<br />
</div>
<div><br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">byte</code><code style="color:#000000;">[] screenshot = GetScreenShot(player, 1, 90);</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">FileStream fileStream = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">FileStream(filename, FileMode.Create, FileAccess.ReadWrite);</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">BinaryWriter binaryWriter = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">BinaryWriter(fileStream);</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">binaryWriter.Write(screenshot);</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">binaryWriter.Close();</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">PrintDocument pd = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">PrintDocument();</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">pd.PrintPage += (</code><code style="color:#006699;font-weight:bold;">object</code> <code style="color:#000000;">printSender, PrintPageEventArgs printE) =&gt;</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">var img = System.Drawing.Image.FromFile(filename);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">printE.Graphics.DrawImageUnscaled(img, </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">System.Drawing.Point(0, 0));</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">};</code></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">PrintDialog dialog = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">PrintDialog();</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">dialog.ShowDialog();</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">pd.Print();&nbsp; </code></span></div>
</div>
&nbsp;
<br />
<br />
</div>
<h2><a name="Landscape_Printing"></a>6. Landscape Printing</h2>
<div><br />
In this example, there are two printing buttons. the first prints the parent grid, which prints the buttons, scrollviewer and it&#39;s contents. This shows as a cut off print. <br />
The second example prints the TextBlock itself, which is inside a ScrollViewer, so is not actually constrained at all. This version prints perfectly stretched, showing all of the text.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">private</code> <code style="color:#006699;font-weight:bold;">void</code> <code style="color:#000000;">Button_Click2(</code><code style="color:#006699;font-weight:bold;">object</code> <code style="color:#000000;">sender, RoutedEventArgs e)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">PrintDialog printDialog = </code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">PrintDialog();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">printDialog.PrintTicket.PageOrientation = PageOrientation.Landscape;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">printDialog.PrintVisual(printBlock, </code><code style="color:blue;">&quot;Landscape working TextBox print&quot;</code><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/6574.printing7.png"></a><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/0825.printing7.png"><img alt=" " width="337" height="338" style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/0825.printing7.png" /></a><br />
<br />
<hr />
<br />
<span style="color:#ff0000;">Note: XPS and JPG files generated from the project are saved in &quot;.../MyDocuments/PrintingTest&quot;</span><br />
</div>
<span style="color:#333333;font-family:segoe ui;">
<div><strong><span style="font-size:14px;"><br />
Don&#39;t forget to download this project&nbsp;from MSDN Samples:<br />
</span></strong></div>
<strong><span style="font-size:14px;"></span></strong>
<div><a href="http://code.msdn.microsoft.com/WPF-Printing-Overview-f28c541a/edit?newSession=True"><strong><span style="color:#0066dd;font-size:14px;"></span></strong></a><span style="font-size:13px;"><a href="http://code.msdn.microsoft.com/WPF-Printing-Overview-f28c541a"><strong>http://code.msdn.microsoft.com/WPF-Printing-Overview-f28c541a</strong></a></span><br />
<br />
<span style="font-size:12px;">(...and please rate it if you like it ;)</span></div>
</span><em></em>
<a><img alt=" " style="border:currentcolor;" src="http://c.statcounter.com/8222032/0/4f2d8061/1/" /></a></div>
    
    

    <!-- AUTO ADDED BELOW -->

    <div id='theFooter'></div>

    <script type='text/javascript'>
    
        var headerContainer = jQuery('#theHeader');
        jQuery.ajax({
            url: 'include/GitHubPagesWikiHeader.html',
            success: function (data) {
                headerContainer.html(data);
            }
        });

        var footerContainer = jQuery('#theFooter');
        jQuery.ajax({
            url: 'include/GitHubPagesWikiFooter.html',
            success: function (data) {
                footerContainer.html(data);
            }
        });       

    </script>
</body>

</html>