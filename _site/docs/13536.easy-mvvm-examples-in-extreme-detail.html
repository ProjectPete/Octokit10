<html !DOCTYPE html>

<head>
    <script type='text/javascript' src='https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.5.2.min.js'></script>
    <link rel='stylesheet' type='text/css' href='include/LayoutMisc.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle2.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle3.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/DynamicStyle.css' xmlns='http://www.w3.org/1999/xhtml'>
</head>

<body style='margin:20px !important;'>

    <div id='theHeader'></div>

    <div id='theBreadcrumb'>
        <div class='breadcrumb-list'>
    <span class='breadcrumb-item'><a class='internal-link view-home' href='https://github.com/ProjectPete/Octokit10/tree/master/docs'>Wiki</a></span>

    <span class='separator'><span style='display:none;'></span>&nbsp;&gt;&nbsp;</span>
    <span class='breadcrumb-item'>
        <a href='/Octokit10/PageIndex1.html'>TechNet Articles</a>
    </span>

    <span class='breadcrumb-item'>
        <span class='separator'><span style='display:none;'></span>&nbsp;&gt;&nbsp;</span>
        <span class='breadcrumb-item'>
            <a href='https://github.com/ProjectPete/Octokit10/tree/master/docs/13536.easy-mvvm-examples-in-extreme-detail.html' class='last'>Easy MVVM examples (in extreme detail) - TechNet Articles - United States (English) - TechNet Wiki</a>
        </span>
    </span>
</div>

    </div>

    <div id='theOther'>
        <div class='content-fragment page-navigation no-wrapper' id='fragment-6614'>
    <div class='content-fragment-inner fiji-content-fragment-inner'>
        <div class='content-fragment-top fiji-content-fragment-top'><div class='r1 fiji-r1'></div><div class='r2 fiji-r2'></div><div class='r3 fiji-r3'></div><div class='r4 fiji-r4'></div></div><div class='content-fragment-content'>

            <div class='navigation-list-header'></div>
            <ul class='navigation-list'>

                <li class='navigation-item selected'>
                    <a class='internal-link view-wiki-page' href='#'>
                        <span></span>
                        Article
                    </a>
                </li>

                <li class='navigation-item'>
                    <a class='internal-link wiki-page-history' href='https://github.com/ProjectPete/Octokit10/commits/master/docs/13536.easy-mvvm-examples-in-extreme-detail.html'>
                        <span></span>
                        History
                    </a>
                </li>

            </ul>
            <div class='navigation-list-footer'></div>
        </div>
        <div class='content-fragment-footer'></div>
        <div class='content-fragment-bottom fiji-content-fragment-bottom'><div class='r1 fiji-r1'></div><div class='r2 fiji-r2'></div><div class='r3 fiji-r3'></div><div class='r4 fiji-r4'></div></div>
    </div>
</div>
    </div>

    <h1 class='post-name'>Easy MVVM examples (in extreme detail) - TechNet Articles - United States (English) - TechNet Wiki</h1>
            
    <!-- AUTO ADDED ABOVE -->

    <div class="post-content user-defined-markup">

<strong>This article discusses the various methods and tricks used in MVVM, to enable a developer to completely separate the user interface from the code. It demonstrates all the basics with easy examples to follow, in a downloadable project.<br />
</strong><br />
<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Introduction">Introduction</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#About_the_Sample_Project">About the Sample Project</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Classic_INotifyPropertyChanged">Classic INotifyPropertyChanged</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Switching_windows_from_traditional_event_handlers_in_code-behind">Switching Windows from Event Handlers in Code-behind</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#DataContext_Made_in_Code">DataContext Made in Code</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Closing_Windows_from_the_ViewModel">Closing Windows from the ViewModel</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Using_DependencyObject_instead_of_INPC">Using DependencyObject instead of INPC</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Controlling_an_Application_through_CanExecute">Controlling an Application through CanExecute</a></li><li class="hierarchy-item"><a href="#Closing_with_a_Attached_Property_via_Dependency_Property">Closing with Attached Property via Dependency Property</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Using_POCO_objects_with_MVVM">Using POCO Objects with MVVM</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Custom_Event_Self-close_Hack">Custom Event Self-close Hack</a></li><li class="hierarchy-item"><a href="#Tweaking_one_property_to_show_the_difference">Fixing One Property to Show the Difference</a></li><li class="hierarchy-item"><a href="#A_Cleaner_Interface_Way_to_Close_the_Window">A Cleaner &#39;Interface&#39; Way to Close the Window</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#How_to_consume_a_closed_Business_Object_database_layer_web_service">How to Consume a Closed Business Object (database layer, web service)</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Wrapping_POCOs">Wrapping POCOs</a></li><li class="hierarchy-item"><a href="#Polling_POCOs">Polling POCOs</a></li><li class="hierarchy-item"><a href="#Codeless_Master_Detail_CRUD_for_databases_web_services_etc">Virtually Codeless Master/Detail CRUD Control</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#How_to_bind_and_when_to_update">How to Bind and When to Update</a></li><li class="hierarchy-item"><a href="#Add_Update_or_Delete">Create, Update, Delete Logic</a></li></ul><div class="hierarchy-list-footer"> </div></li></ul><div class="hierarchy-list-footer"> </div></li></ul><div class="hierarchy-list-footer"> </div></div><br />
<h1><a name="Introduction"></a>Introduction</h1>
<br />
<strong>Model View ViewModel</strong> is the golden child of WPF, allowing a developer to completely separate their application code from any UI dependencies.
<br />
<br />
This means an application can be easily be re-skinned, and it also makes&nbsp;an application much&nbsp;easier to test.
<br />
<br />
The <strong>View</strong> represents any front-end user interface controls (Window, Page, UserControl), the
<strong>Model</strong> represents the classes used in the application, and the <strong>
ViewModel</strong> is the middle-man that requests, molds and exposes the data, as properties and commands.<br />
&nbsp;<br />
<h2><a name="About_the_Sample_Project"></a><strong>About the Sample Project</strong></h2>
<br />
This is article is linked to a TechNet sample project that you can download and explore.
<br />
It covers many basic concepts of MVVM, and some of the common pitfalls and solutions.<br />
<br />
<strong>The idea is to download the sample, run it to see each example, then read through this, along side the code.</strong><br />
<strong>By the time you have finished, you should know&nbsp;most of&nbsp;what you need to know :)<br />
</strong>&nbsp;<br />
&nbsp;<br />
<span style="font-size:14px;"><strong><span style="font-size:14px;">DOWNLOAD :</span></strong><a href="http://gallery.technet.microsoft.com/Easy-MVVM-Examples-48c94de3"><span style="font-size:14px;"><strong>&nbsp;http://gallery.technet.microsoft.com/Easy-MVVM-Examples-48c94de3</strong></span></a><br />
</span><br />
<br />
If you&#39;re looking for more good WPF examples, you will probably enjoy <a href="http://code.msdn.microsoft.com/site/search?f%5B0%5D.Type=User&amp;f%5B0%5D.Value=XAML%20guy">
my other Gallery sample projects</a>. all I ask is that you rate (star)&nbsp;them, thanks.<br />
<h1>&nbsp;</h1>
<p>â†‘ <a href="http://social.technet.microsoft.com/wiki/contents/articles/13536.easy-mvvm-examples-in-extreme-detail.aspx#Top">
<span style="color:#0066dd;">Return to Top</span></a></p>
<hr />
<p>&nbsp;</p>
<h1><a name="Classic_INotifyPropertyChanged"></a>Classic INotifyPropertyChanged</h1>
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/0336.mvvm1.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/456x0/__key/communityserver-wikis-components-files/00-00-00-00-05/0336.mvvm1.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
This first example&nbsp;is <strong>the classic MVVM configuration</strong>, implementing
<strong>INotifyPropertyChanged</strong> in a base class (<strong>ViewModelBase</strong>)<br />
&nbsp;<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">class</code>
<code style="color:#000000;">ViewModelBase : INotifyPropertyChanged</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">internal</code>
<code style="color:#006699;font-weight:bold;">void</code> <code style="color:#000000;">
RaisePropertyChanged(</code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">prop)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(PropertyChanged != </code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">) { PropertyChanged(</code><code style="color:#006699;font-weight:bold;">this</code><code style="color:#000000;">,
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
PropertyChangedEventArgs(prop)); }</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">event</code> <code style="color:#000000;">
PropertyChangedEventHandler PropertyChanged;</code></span></span></div>
</div>
<br />
This base class contains the common code used by all properties of all other derived ViewModels, one is shown below.<br />
&nbsp;<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">_TextProperty1;</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">string</code> <code style="color:#000000;">
TextProperty1</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">get</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">_TextProperty1;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">set</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(_TextProperty1 != value)</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">_TextProperty1 = value;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RaisePropertyChanged(</code><code style="color:blue;">&quot;TextProperty1&quot;</code><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
As you can see, it looks like a standard CLI object, but with the extra <strong>RaisePropertyChanged</strong> method in the setter.<br />
<br />
In example 1, the ViewModel is attached by the View itself, <strong>in XAML</strong>. Notice this is possible because the ViewModel does not need any parameters in it&#39;s constructor.<br />
&nbsp;<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">Window</code>
<code style="color:#000000;">. . .</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">xmlns:vm</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;clr-namespace:MvvmExample.ViewModel&quot;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">DataContext</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;{DynamicResource ViewModelMain}&quot;</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">Window.Resources</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">vm:ViewModelMain</code>
<code style="color:#808080;">x:Key</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;ViewModelMain&quot;</code><code style="color:#000000;">/&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;/</code><code style="color:#006699;font-weight:bold;">Window.Resources</code><code style="color:#000000;">&gt;</code></span></span></div>
</div>
<br />
There is a <strong>ListBox</strong>, <strong>DataGrid</strong> and <strong>ComboBox,</strong>&nbsp;ALL with
<em>ItemsSource</em> to the same collection, and the same <em>SeletedItem</em>.<br />
Changes to&nbsp;the values of any of the properties in the DataGrid&nbsp;are reflected across all controls.<br />
As you change the selected Person in any of these controls, you will see all three change together.<br />
A TextBox and TextBlock share the same property, so changes in the TextBox reflect in the TextBlock.<br />
Click the button to add a user, it shows in all three controls.<br />
<br />
Although many would think that this is all due to our &#39;enriched&#39; INPC classes, most of this is
<strong>actually triggered by changing the values through the UI</strong>, as explained later.<br />
&nbsp; <br />
Only the Add user command relies on PropertyChanged events, and they come from the changing ObservableCollection.<br />
&nbsp;<br />
<h2><a name="Switching_windows_from_traditional_event_handlers_in_code-behind"></a><strong>Switching&nbsp;Windows from Event Handlers in&nbsp;Code-behind</strong></h2>
<br />
A traditional method of triggering functions&nbsp;and navigating from one&nbsp;window to another is using code-behind event handlers.<br />
This&nbsp;means your code is tightly coupled with the user interface.<br />
&nbsp;<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">private</code>
<code style="color:#006699;font-weight:bold;">void</code> <code style="color:#000000;">
Button_Click(</code><code style="color:#006699;font-weight:bold;">object</code> <code style="color:#000000;">
sender, RoutedEventArgs e)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">var win =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
Window1 { DataContext = </code><code style="color:#006699;font-weight:bold;">new</code>
<code style="color:#000000;">ViewModelWindow1(tb1.Text) };</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">win.Show();</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">this</code><code style="color:#000000;">.Close();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
The most common first question in MVVM is<strong> how to call methods of a control like Window.Close() from a ViewModel</strong>.
<br />
&nbsp;<br />
<strong>This is shown in the next example.</strong><br />
<br />
<p>â†‘ <a href="http://social.technet.microsoft.com/wiki/contents/articles/13536.easy-mvvm-examples-in-extreme-detail.aspx#Top">
<span style="color:#0066dd;">Return to Top</span></a></p>
<hr />
<br />
<h1><a name="DataContext_Made_in_Code"></a>DataContext Made in Code</h1>
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/6710.mvvm2.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/345x0/__key/communityserver-wikis-components-files/00-00-00-00-05/6710.mvvm2.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
The second example&nbsp;simply shows how you can attach the ViewModel to the DataContext&nbsp;<strong>from code</strong>, done by the previous window shown above, as this window was created.<br />
&nbsp;<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">var win =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
Window1 { DataContext = </code><code style="color:#006699;font-weight:bold;">new</code>
<code style="color:#000000;">ViewModelWindow1(tb1.Text) };</code></span></div>
</div>
<br />
In this example, the ViewModel takes a string parameter in it&#39;s constructor. Work done in the constructor is BEFORE binding occurs, so we can populate
<strong>private variables</strong>:<br />
&nbsp;<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">ViewModelWindow1(</code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">lastText)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">_TestText = lastText;</code></span></span></div>
</div>
<br />
This ViewModel is derived from ViewModelMain, with an extra public property and command to pull a value&nbsp;from the base class and update this new property.<br />
<br />
The Button command passes in a value from the UI in the <strong>CommandParameter</strong>.&nbsp;This saves us having to reference controls directly from code.<br />
&nbsp;<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">Button</code>
<code style="color:#808080;">Content</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;Change Text&quot;</code>
<code style="color:#808080;">Command</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;{Binding ChangeTextCommand}&quot;</code>
<code style="color:#808080;">CommandParameter</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;{Binding SelectedItem, ElementName=dg1}&quot;</code><code style="color:#000000;">/&gt;</code></span></div>
</div>
<br />
In this example, the selected person is used to make the value for <strong>public property</strong> TestText.
<br />
<br />
This command is triggered <strong>AFTER</strong> the page has finished binding, so we target the
<strong>public property</strong>, so the <strong>PropertyChanged event is triggered</strong>.<br />
<br />
This is so the bindings related to that property know that they need to update, otherwise changes will never be reflected in the UI.<br />
&nbsp;<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">ChangeText(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">selectedItem)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(selectedItem == </code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">TestText =
</code><code style="color:blue;">&quot;Please select a person&quot;</code><code style="color:#000000;">;
</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">else</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">var person = selectedItem
</code><code style="color:#006699;font-weight:bold;">as</code> <code style="color:#000000;">
Person;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">TestText = person.FirstName &#43;
</code><code style="color:blue;">&quot; &quot;</code> <code style="color:#000000;">&#43; person.LastName;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<h2>&nbsp;</h2>
<h2><a name="Closing_Windows_from_the_ViewModel"></a><strong>Closing Windows from the ViewModel</strong></h2>
<br />
This second example shows a nice way to <strong>close a window</strong>&nbsp;<strong>from a ViewModel</strong>, using an
<strong>Attached Behavior</strong>. <br />
&nbsp;<br />
The &quot;<strong>close window</strong>&quot; behavior is added from an <strong>attached property</strong> called
<strong>DialogResult</strong>.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
class</code> <code style="color:#000000;">DialogCloser</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
readonly</code> <code style="color:#000000;">DependencyProperty DialogResultProperty =</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">DependencyProperty.RegisterAttached(</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;DialogResult&quot;</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">typeof</code><code style="color:#000000;">(</code><code style="color:#006699;font-weight:bold;">bool</code><code style="color:#000000;">?),</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">typeof</code><code style="color:#000000;">(DialogCloser),</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">new</code>
<code style="color:#000000;">PropertyMetadata(DialogResultChanged));</code></span></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">private</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
void</code> <code style="color:#000000;">DialogResultChanged(</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">DependencyObject d,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">DependencyPropertyChangedEventArgs e)</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">var window = d
</code><code style="color:#006699;font-weight:bold;">as</code> <code style="color:#000000;">
Window;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(window != </code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">)&nbsp; window.Close();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
void</code> <code style="color:#000000;">SetDialogResult(Window target, </code><code style="color:#006699;font-weight:bold;">bool</code><code style="color:#000000;">? value)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">target.SetValue(DialogResultProperty, value);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
This is then attached to the Windows that we want to control:<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">Window</code>
<code style="color:#808080;">x:Class</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;MvvmExample.ViewModel.Window1&quot;</code>
<code style="color:#808080;">WindowStartupLocation</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;CenterScreen&quot;</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">xmlns</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a>&quot;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">xmlns:x</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</a>&quot;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">Title</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;Window1&quot;</code>
<code style="color:#808080;">Height</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;300&quot;</code>
<code style="color:#808080;">Width</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;400&quot;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><strong><code style="color:#808080;">xmlns:helpers</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;clr-namespace:MvvmExample.Helpers&quot;</code></strong></span></span></div>
<div style="background-color:#f8f8f8;"><span><code><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></code><span><strong><code style="color:#808080;">helpers:DialogCloser.DialogResult</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;{Binding
 CloseWindowFlag}&quot;</code></strong><code style="color:#000000;">&gt;</code></span></span></div>
</div>
<br />
As all our Windows use ViewModels, which all inherit from <strong>ViewModelBase</strong>, we can put this generic window closer property and Close method<strong> in the base class</strong>:<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">bool</code><code style="color:#000000;">? _CloseWindowFlag;</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">bool</code><code style="color:#000000;">? CloseWindowFlag</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">get</code>
<code style="color:#000000;">{ </code><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">_CloseWindowFlag; }</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">set</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">_CloseWindowFlag = value;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RaisePropertyChanged(</code><code style="color:blue;">&quot;CloseWindowFlag&quot;</code><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">virtual</code> <code style="color:#006699;font-weight:bold;">
void</code> <code style="color:#000000;">CloseWindow(</code><code style="color:#006699;font-weight:bold;">bool</code><code style="color:#000000;">? result =
</code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">)</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Application.Current.Dispatcher.BeginInvoke(DispatcherPriority.Background,
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
Action(() =&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">CloseWindowFlag = CloseWindowFlag ==
</code><code style="color:#006699;font-weight:bold;">null</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">?
</code><code style="color:#006699;font-weight:bold;">true</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">: !CloseWindowFlag;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}));</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
Our actual <strong>ViewModel can now handle navigation and closing windows</strong> as shown:<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">NextExample(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">parameter)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">var win =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
Window2();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">win.Show();</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;"><strong>CloseWindow();</strong></code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
<br />
<p>â†‘ <a href="http://social.technet.microsoft.com/wiki/contents/articles/13536.easy-mvvm-examples-in-extreme-detail.aspx#Top">
<span style="color:#0066dd;">Return to Top</span></a></p>
<hr />
<br />
<h1><a name="Using_DependencyObject_instead_of_INPC"></a>Using DependencyObject instead of INPC</h1>
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/0272.mvvm3.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/316x0/__key/communityserver-wikis-components-files/00-00-00-00-05/0272.mvvm3.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
This example shows the alternative to INotifyPropertyChanged - <strong>DependencyObject</strong> and
<strong>Dependency Properties</strong>.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">class</code>
<code style="color:#000000;">ViewModelWindow2 : DependencyObject</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">Person SelectedPerson</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">get</code>
<code style="color:#000000;">{ </code><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">(Person)GetValue(SelectedPersonProperty); }</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#000000;">{ SetValue(SelectedPersonProperty, value); }</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
readonly</code> <code style="color:#000000;">DependencyProperty SelectedPersonProperty =</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">DependencyProperty.Register(</code><code style="color:blue;">&quot;SelectedPerson&quot;</code><code style="color:#000000;">,
</code><code style="color:#006699;font-weight:bold;">typeof</code><code style="color:#000000;">(Person),
</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">typeof</code><code style="color:#000000;">(ViewModelWindow2),
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
UIPropertyMetadata(</code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">));</code></span></span></div>
</div>
<div class="endscriptcode"><br />
<strong>Dependency Properties</strong> are considered a &quot;<strong>richer</strong>&quot; method of binding, as the Register method also has several&nbsp;overloads&nbsp;for
<strong>PropertyChanged</strong> and <strong>Coerce</strong> delegate methods.</div>
<p>The&nbsp;main drawback to <strong>Dependency Properties</strong> for general MVVM use is
<strong>they need to be handled on the UI layer</strong>.</p>
<p>For more on the <strong>INPC vs DP debate</strong>, read the following:</p>
<ul>
<li><a href="http://kentb.blogspot.co.uk/2009/03/view-models-pocos-versus.html">http://kentb.blogspot.co.uk/2009/03/view-models-pocos-versus.html</a>
</li></ul>
<p>&nbsp;</p>
<h2><a name="Controlling_an_Application_through_CanExecute"></a><strong>Controlling an Application through CanExecute</strong></h2>
<p>This example also shows how a command can also control&nbsp;whether a button is enabled or not, through it&#39;s CanExecute delegate.
<br />
This again moves away from controller and more into behavior. <br />
The action cannot even be triggered if conditions are not met, and this is clear to the user as the button is disabled.</p>
<p>We are not using the command parameter in this example, but relying on a ViewModel property to be populated with the selected item.
<br />
If there is none, the <strong>CanExecute</strong> method returns <strong>false</strong>, which
<strong>disables the button</strong>. <br />
<br />
All encapsulated in the command, nice clean code.<br />
&nbsp;</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">public ViewModelWindow2()</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">People = FakeDatabaseLayer.GetPeopleFromDatabase();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">NextExampleCommand = new RelayCommand(NextExample, NextExample_CanExecute);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">bool NextExample_CanExecute(object parameter)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">return SelectedPerson != null;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<p>&nbsp;</p>
<h2><a name="Closing_with_a_Attached_Property_via_Dependency_Property"></a><strong>Closing with Attached Property via Dependency Property</strong></h2>
<p>To close the window in this example, we still use the <strong>Attached Property</strong> in the Window XAML, but the property is&nbsp;a
<strong>Dependency Property</strong> in the ViewModel.<br />
&nbsp;</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">bool</code><code style="color:#000000;">? CloseWindowFlag</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">get</code>
<code style="color:#000000;">{ </code><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">(</code><code style="color:#006699;font-weight:bold;">bool</code><code style="color:#000000;">?)GetValue(CloseWindowFlagProperty); }</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#000000;">{ SetValue(CloseWindowFlagProperty, value); }</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#008200;">// Using a DependencyProperty as the backing store for CloseWindowFlag.&nbsp; This enables animation, styling, binding, etc...</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
readonly</code> <code style="color:#000000;">DependencyProperty CloseWindowFlagProperty =
</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">DependencyProperty.Register(</code><code style="color:blue;">&quot;CloseWindowFlag&quot;</code><code style="color:#000000;">,
</code><code style="color:#006699;font-weight:bold;">typeof</code><code style="color:#000000;">(</code><code style="color:#006699;font-weight:bold;">bool</code><code style="color:#000000;">?),
</code><code style="color:#006699;font-weight:bold;">typeof</code><code style="color:#000000;">(ViewModelWindow2),
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
UIPropertyMetadata(</code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">));</code></span></span></div>
</div>
<p>&nbsp;<br />
Used simply as follows:<br />
&nbsp;</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">NextExample(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">parameter)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">var win =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
Window3(SelectedPerson);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">win.Show();</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">CloseWindowFlag =
</code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<p>&nbsp;&nbsp;&nbsp;</p>
<p>â†‘ <a href="http://social.technet.microsoft.com/wiki/contents/articles/13536.easy-mvvm-examples-in-extreme-detail.aspx#Top">
<span style="color:#0066dd;">Return to Top</span></a></p>
<hr />
<p>&nbsp;</p>
<h1><a name="Using_POCO_objects_with_MVVM"></a>Using POCO Objects with MVVM</h1>
<p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8664.mvvm4.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/437x0/__key/communityserver-wikis-components-files/00-00-00-00-05/8664.mvvm4.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
A POCO class in WPF/MVVM terms is one that does not provide any PropertyChanged events.
</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">class</code>
<code style="color:#000000;">PocoPerson</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">string</code> <code style="color:#000000;">
FirstName { </code><code style="color:#006699;font-weight:bold;">get</code><code style="color:#000000;">;
</code><code style="color:#006699;font-weight:bold;">set</code><code style="color:#000000;">; }</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">string</code> <code style="color:#000000;">
LastName { </code><code style="color:#006699;font-weight:bold;">get</code><code style="color:#000000;">;
</code><code style="color:#006699;font-weight:bold;">set</code><code style="color:#000000;">; }</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">int</code> <code style="color:#000000;">
Age { </code><code style="color:#006699;font-weight:bold;">get</code><code style="color:#000000;">;
</code><code style="color:#006699;font-weight:bold;">set</code><code style="color:#000000;">; }</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<p>This would usually be legacy code modules, or converting from WinForms.<br />
This next example demonstrates how things start to break, when you don&#39;t use PropertyChanged events.<br />
<br />
At first, everything seems fine. Selected item is updated in all, you can change properties of existing people, and add new people through the DataGrid.<br />
<br />
Those actions are all UI based actions, which change <strong>Dependency Properties</strong> like
<strong>TextBox.Text</strong>,&nbsp;and automatically&nbsp;fire the <strong>PropertyChanged</strong> event.<br />
<br />
<strong>However</strong>, the <strong>TextBox</strong> should actually be showing a
<strong>time stamp</strong>, as set by the code behind <strong>Dispatcher Timer</strong>.</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">ViewModelWindow3(Person person)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">. . . snip . . .</code></span></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">timer =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
DispatcherTimer();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">timer.Interval = TimeSpan.FromSeconds(1);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">timer.Tick &#43;=
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
EventHandler(timer_Tick);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">timer.Start();</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">timer_Tick(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">sender, EventArgs e)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">TextProperty1 = DateTime.Now.ToString();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<p><strong>Furthermore</strong>, clicking the <strong>Button</strong> to add a new person<strong> does not seem to work</strong>, but it did.<br />
<br />
If&nbsp;you then&nbsp;try to add a user in the DataGrid, the binding updates, and shows the previously added user.
<strong>All a bit broken.</strong></p>
<h2><a name="Custom_Event_Self-close_Hack"></a>&nbsp;<br />
<strong>Custom Event Self-close Hack</strong></h2>
<p>Just as an alternative, this ViewModel has a custom event, to signify closure, which is handled in code behind when the ViewModel is attached.</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">Window3(Person person)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">InitializeComponent();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">var vm =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
ViewModelWindow3(person);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">DataContext = vm;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">vm.CloseWindowEvent &#43;=
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
System.EventHandler(vm_CloseWindowEvent);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">vm_CloseWindowEvent(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">sender, System.EventArgs e)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">this</code><code style="color:#000000;">.Close();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
<br />
<h2><a name="Tweaking_one_property_to_show_the_difference"></a><strong>Fixing&nbsp;One Property to Show the Difference</strong></h2>
<p>&nbsp;<br />
The following window is&nbsp;<strong>almost identical</strong> to the <strong>previous POCO example</strong>. However
<strong>TextProperty1 now&nbsp;triggers a PropertyChanged event</strong>&nbsp;in it&#39;s setter.
<br />
&nbsp;</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">set</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(_TextProperty1 != value)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">_TextProperty1 = value;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RaisePropertyChanged(</code><code style="color:blue;">&quot;TextProperty1&quot;</code><code style="color:#000000;">);
</code><code style="color:#008200;">//The fix</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<p>&nbsp;<br />
Now you will find <strong>the time stamp property shows</strong> through onto the TextBox as shown below.<br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4721.mvvm5.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/437x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4721.mvvm5.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
However, with events coming from the INPC interface, the <strong>other UI bindings are now even more broken</strong>.
<span style="color:#ff0000;">(Try the sample project)</span><br />
<br />
</p>
<h2><a name="A_Cleaner_Interface_Way_to_Close_the_Window"></a><strong>A Cleaner &#39;Interface&#39; Way to Close the Window</strong></h2>
<p>The behaviour of closing a window, could happily be kept with the window, if you believe that is where it belongs.
<br />
<br />
One way of always assuring any ViewModel has the expected event shown above would be to make our ViewModels (ideally in the ViewModelBase) inherit an
<strong>interface</strong> that defines the event.<br />
<br />
We can then safely <strong>cast any ViewModel back to this interface</strong>, and attach a handler to the expected event.<br />
<br />
</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">Window4()</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">InitializeComponent();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">DataContextChanged &#43;=
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
DependencyPropertyChangedEventHandler(Window4_DataContextChanged);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">Window4_DataContextChanged(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">sender, DependencyPropertyChangedEventArgs e)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">var dc = DataContext
</code><code style="color:#006699;font-weight:bold;">as</code> <code style="color:#000000;">
IClosableViewModel;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">dc.CloseWindowEvent &#43;=
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
EventHandler(dc_CloseWindowEvent);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
<p>â†‘ <a href="http://social.technet.microsoft.com/wiki/contents/articles/13536.easy-mvvm-examples-in-extreme-detail.aspx#Top">
<span style="color:#0066dd;">Return to Top</span></a></p>
<hr />
<br />
<h1><a name="How_to_consume_a_closed_Business_Object_database_layer_web_service"></a>How to Consume a Closed Business Object (database layer, web service)</h1>
<p>The&nbsp;most important message to learn from all of this is that<strong> if you can convert the base (model) classes that you use to INPC properties,&nbsp;DO&nbsp;SO NOW</strong>. You will save yourself a world of pain, unnecessary&nbsp;data marshalling&nbsp;through wrappers, and
 a whole load of code that can introduce bugs and dependencies to your implementation.<br />
<br />
&nbsp; <br />
But what if you have a <strong>Business Object</strong> that handles all the work, like an
<strong>existing&nbsp;database&nbsp;module</strong>, or <strong>web service client</strong>?</p>
<div class="endscriptcode">This&nbsp;may therefore be a &quot;<strong>closed object</strong>&quot; that you cannot enrich with INPC on it&#39;s properties.</div>
<div class="endscriptcode"><br />
In this case you have to fall back on <strong>wrappers and polling</strong>.<br />
<br />
This final example ViewModel&nbsp;<strong>acts as&nbsp;a&nbsp;shepherd</strong> between our front end controls and a&nbsp;&quot;<strong>personnel management</strong>&quot;&nbsp;business object. It&nbsp;only exposes&nbsp;the following methods:<br />
<ul>
<li><strong><span style="font-size:14px;">GetEmployees()</span></strong> <strong><span style="font-size:14px;"></span></strong></li><li><strong><span style="font-size:14px;">AddPerson(Person)</span></strong> <strong>
<span style="font-size:14px;"></span></strong></li><li><strong><span style="font-size:14px;">DeletePerson(Person)</span></strong> <strong>
<span style="font-size:14px;"></span></strong></li><li><strong><span style="font-size:14px;">UpdatePerson(Person)</span></strong> </li></ul>
</div>
<div class="endscriptcode"><strong></strong><br />
It also has a public POCO string property <strong>ReportTitle</strong>.<br />
<br />
Finally,&nbsp;there a &quot;<strong>Status</strong>&quot; enum (<strong>Offline, Online</strong>) which&nbsp;<strong>periodically&nbsp;toggles</strong> from a [<strong>background thread] Timer</strong>.<br />
<br />
</div>
<h2 class="endscriptcode"><a name="Wrapping_POCOs"></a><strong>Wrapping POCOs</strong></h2>
<div class="endscriptcode"><br />
Firstly, we need to <strong>marshal the data in and out</strong> of the business object. We need to wrap the&nbsp;data in
<strong>marshalling&nbsp;properties</strong>.<br />
<br />
As we only have a <strong>GET method </strong>for employee list, we only need a public property with a get method, to populate our DataGrid:<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">ObservableCollection&lt;PocoPerson&gt; _People;</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">ObservableCollection&lt;PocoPerson&gt; People</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">get</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">_People =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
ObservableCollection&lt;PocoPerson&gt;(<strong>personnel.GetEmployees</strong>());</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">_People;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
The public string property&nbsp;&quot;<strong>Report Title</strong>&quot;&nbsp;is a <strong>two-way pass-through wrapper
</strong>(getter and setter). It marshals the values in and out.<br />
&nbsp;<br />
This takes us back to our first POCO example, where this is sufficient for some operations, but changes to the &quot;back-end&quot; data,
<strong>will not automatically be reflected in the UI</strong>. <br />
<br />
There is a <strong>Label </strong>also bound to this property, but again it only works
<strong>because the change was UI initiated</strong>, as explained in earlier examples.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">string</code> <code style="color:#000000;">
ReportTitle</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">get</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">personel.ReportTitle;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">set</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(personel.ReportTitle != value)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">personnel.ReportTitle = value;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RaisePropertyChanged(</code><code style="color:blue;">&quot;ReportTitle&quot;</code><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
</div>
<h2 class="endscriptcode"><a name="Polling_POCOs"></a><strong>Polling POCOs</strong></h2>
<div class="endscriptcode"><br />
The final property (BoStatus) represents the business object &quot;<strong>Status</strong>&quot; property (personel.Status), but&nbsp;this&nbsp;value is constantly updated by another thread, so we would normally miss the updates in the user interface.
<br />
<br />
The only answer is to<strong> poll the property for changes</strong>.&nbsp;<br />
<br />
BoStatus is therefore <strong>not a wrapper</strong>, but a <strong>store of the &quot;last known&quot; value</strong>.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">MvvmExample.Model.PersonelBusinessObject.StatusType _BoStatus;</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">MvvmExample.Model.PersonelBusinessObject.StatusType BoStatus</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">get</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">_BoStatus;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">set</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(_BoStatus != value)</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">_BoStatus = value;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RaisePropertyChanged(</code><code style="color:blue;">&quot;BoStatus&quot;</code><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
We use a <strong>Timer </strong>to frequently <strong>check the property for changes</strong>. This may seem expensive, but it&#39;s really not, in computer processor terms.<br />
<br />
When we detect a change, we <strong>update the Public property BoStatus</strong>, which saves the new value locally, and
<strong>fires the PropertyChanged event</strong>. <br />
<br />
Anything consuming this property will <strong>update their bindings</strong>, and call the getter to pick up the new value.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">CheckStatus(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">sender, EventArgs e)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(_BoStatus != personel.Status)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">BoStatus = personel.Status;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
Using the <strong>CRUD</strong> methods of our business object is really down to <strong>
your own</strong> personal design and implementation. <br />
<br />
However, as a final example, I included a <strong>very simple method for doing this</strong>, with
<strong>practically no code</strong>!<br />
<br />
&nbsp;</div>
<h2><a name="Codeless_Master_Detail_CRUD_for_databases_web_services_etc"></a><strong>Virtually Codeless Master/Detail CRUD&nbsp;Control</strong></h2>
<p><span style="font-size:12px;">&nbsp;<br />
This example shows a complete and virtually codeless master/detail, CRUD control (for databases, web services, etc)<br />
&nbsp; <br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/3005.mvvm6.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/537x0/__key/communityserver-wikis-components-files/00-00-00-00-05/3005.mvvm6.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
By <strong>master/detail</strong>, we mean there is a master list of objects. You then select a list item to get the item details in a separate box.<br />
<br />
By <strong>CRUD</strong>, we mean <strong>Cr</strong>eate, <strong>U</strong>pdate and
<strong>D</strong>elete functionality. The three things you do to objects in a collection, or a database.<br />
<br />
Normally, in a big application,&nbsp;we would design a stand-alone user control for&nbsp;an edit form, but here is a quick trick to produce the whole, fully wired edit form, using the
<strong>ItemsTemplate</strong> for an <strong>ItemsControl</strong>.<br />
<br />
The actual edit grid is&nbsp;a DataTemplate, instead of an actual control.&nbsp;This <strong>
DataTemplate</strong> is used as the <strong>ItemTemplate</strong> for&nbsp;the <strong>
ItemsControl</strong>:<br />
</span></p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">ItemsControl</code>
<code style="color:#808080;">BindingGroup</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;{Binding UpdateBindingGroup, Mode=OneWay}&quot;</code>
<code style="color:#808080;">ItemTemplate</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;{StaticResource UserGrid}&quot;</code>
<code style="color:#808080;">ItemsSource</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;{Binding SelectedPerson, Converter={StaticResource SelectedItemToItemsSource}}&quot;</code><code style="color:#000000;">/&gt;</code></span></div>
</div>
<br />
The <strong>ItemsSource</strong> is tied to the <strong>SelectedPerson</strong> property of our
<strong>ViewModel</strong>. <br />
<br />
If you were just editing, and not adding new users, you could bind this directly to the
<strong>SelectedItem</strong> property of the <strong>DataGrid</strong>, but you will see later why we don&#39;t.<br />
<br />
A <strong>BindingGroup</strong> is defined on the <strong>ItemsControl</strong>, which we use later to
<strong>cancel or commit changes from the form</strong>.<br />
<br />
ItemsSource&nbsp;expects a collection, rather than SelectedItem (SelectedPerson). So to make this trick work, we use a simple converter to wrap the selected person into a collection.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">class</code> <code style="color:#000000;">
SelectedItemToItemsSource : IValueConverter</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">object</code> <code style="color:#000000;">
Convert(</code><code style="color:#006699;font-weight:bold;">object</code> <code style="color:#000000;">
value, Type targetType, </code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">parameter, System.Globalization.CultureInfo culture)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(value == </code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">)
</code><code style="color:#006699;font-weight:bold;">return</code> <code style="color:#006699;font-weight:bold;">
null</code><code style="color:#000000;">;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><strong><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
List&lt;</code><code style="color:#006699;font-weight:bold;">object</code><code style="color:#000000;">&gt;() { value };</code></span></strong></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">object</code> <code style="color:#000000;">
ConvertBack(</code><code style="color:#006699;font-weight:bold;">object</code> <code style="color:#000000;">
value, Type targetType, </code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">parameter, System.Globalization.CultureInfo culture)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">throw</code>
<code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
NotImplementedException();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
<span style="font-size:16px;"><strong><br />
<em><span style="color:#ff0000;">This method means that if there is no selected item, there is no edit form.</span></em></strong><em><span style="color:#ff0000;">&nbsp;<br />
</span></em></span><strong><br />
<span style="font-size:16px;color:#ff0000;"><em>This removes the need for visibility converters,&nbsp;or triggers to show &amp; hide the form!</em></span></strong><br />
<br />
<h3><a name="How_to_bind_and_when_to_update"></a><strong>How to Bind and When to Update</strong></h3>
<p>&nbsp;</p>
<p>Binding to properties of the <strong>selected person</strong>, is only the immediate
<strong>DataContext</strong> of the generated item -&nbsp;<strong>direct and easy</strong>.</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">TextBox</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;{Binding FirstName, BindingGroupName=Group1, UpdateSourceTrigger=Explicit}&quot;</code>
<code style="color:#808080;">Grid.Column</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;1&quot;</code><code style="color:#000000;">/&gt;</code></span></div>
</div>
<br />
<strong>However</strong>, to get back to the <strong>ViewModel</strong> and update our
<strong>&quot;Personnel&quot;&nbsp;Business Object</strong>, we need to traverse further up the <strong>
VisualTree</strong>, for which we use <strong>RelativeSource</strong>:<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">Button</code>
<code style="color:#808080;">Foreground</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;Red&quot;</code>
<code style="color:#808080;">Content</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;Cancel&quot;</code>
<code style="color:#808080;">Command</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;<strong>{Binding DataContext.CancelCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}</strong>&quot;</code>
<code style="color:#808080;">Margin</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;4,0&quot;</code><code style="color:#000000;">/&gt;</code></span></div>
</div>
<br />
This binding traverses back, looking for the first instance of the <strong>ItemsControl</strong>. We then refer to the properties via it&#39;s
<strong>DataContext</strong>.<br />
<br />
To allow us to <strong>cancel an edit</strong>, the binding&#39;s <strong>UpdateSourceTrigger</strong> is changed to
<strong>Explicit</strong>.<br />
<br />
This <strong>prevents</strong> any updates of the <strong>source data</strong>, until we manually call an
<strong>Update</strong> on the bindings.<br />
<br />
As these&nbsp;are <strong>auto-generated</strong> controls and bindings, we would normally&nbsp;have had to use
<strong>VisualTreeHelper</strong> to hunt for the controls in the VisualTree,&nbsp;so that we can locate and&nbsp;call the Update method on the bindings... Yuk... &nbsp;o_O&nbsp;<br />
<br />
<strong>Instead we are using&nbsp;the Binding Group </strong>we earlier attached to the
<strong>ItemsControl</strong>. <br />
<br />
Each binding in the <strong>DataTemplate</strong> also includes a reference to this
<strong>group name</strong>:<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">TextBox</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;{Binding . . . BindingGroupName=Group1, . . .&quot; /&gt;</code></span></div>
</div>
<br />
<strong>The trick to use this in an MVVM scenario</strong> is that this <strong>BindingGroup</strong> needs to be defined in the
<strong>ViewModel</strong>, and passed&nbsp;INTO the ItemsControl, <strong>through binding</strong>.<br />
<br />
It needs to be <strong>already waiting</strong>, if it is to be used by the <strong>
DataTemplate bindings</strong>.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">ItemsControl</code>
<code style="color:#808080;">BindingGroup</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;{Binding UpdateBindingGroup, Mode=OneWay}&quot;</code>
<code style="color:#000000;">. . .&nbsp; /&gt;</code></span></div>
</div>
<br />
This is then just another property of our ViewModel, <strong>that we can use in the ViewModel</strong> and is updated from the UI, as bindings are created and destroyed by the ItemsControl.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">BindingGroup _UpdateBindingGroup;</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">BindingGroup UpdateBindingGroup</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">get</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">_UpdateBindingGroup;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">set</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(_UpdateBindingGroup != value)</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">_UpdateBindingGroup = value;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RaisePropertyChanged(</code><code style="color:blue;">&quot;UpdateBindingGroup&quot;</code><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">ViewModelWindow5()</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">. . .</code></span></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">UpdateBindingGroup =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
BindingGroup { Name = </code><code style="color:blue;">&quot;Group1&quot;</code> <code style="color:#000000;">
};</code></span></span></div>
</div>
<br />
In our command handling methods, we can <strong>update or cancel&nbsp;the&nbsp;changes from our ViewModel</strong>.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">DoCancel(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">param)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">UpdateBindingGroup.CancelEdit();</code></span></span></div>
</div>
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">DoSave(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">param)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">UpdateBindingGroup.CommitEdit();</code></span></span></div>
</div>
<h3>&nbsp;</h3>
<h3><a name="Add_Update_or_Delete"></a><strong>Create, Update, Delete Logic</strong></h3>
<br />
To add a new user, we simply create a new &quot;placeholder&quot; object into SelectedPerson.<br />
This shows and populates the form with the new user object, which we can fill in.<br />
This is why we bind the ItemsControl ItemsSource to SelectedPerson instead of directly to DataGrid.SelectedItem.<br />
<br />
If <strong>new user deleted/cancelled</strong>, we simply set <strong>SeletedPerson</strong> back to
<strong>null</strong>, which disposes of the object.<br />
<br />
If <strong>existing user cancelled</strong>, we call <strong>CancelEdit</strong> on the
<strong>BindingGroup</strong>.<br />
<br />
If <strong>new user&nbsp;saved</strong>, we call <strong>AddUser</strong> on the <strong>
Business Object</strong>, then trigger&nbsp;<strong>PropertyChanged</strong> on the <strong>
People</strong> collection, for a fresh list from the <strong>Business Object</strong>.<br />
<br />
If <strong>existing user saved</strong>, we call <strong>UpdateUser</strong> on the
<strong>Business Object</strong> and <strong>ComitEdit</strong> on the <strong>BindingGroup</strong><br />
<br />
If <strong>existing user deleted</strong>, we call <strong>DeleteUser</strong>&nbsp;on the
<strong>Business Object</strong>,&nbsp;then&nbsp;trigger <strong>PropertyChanged</strong> on the
<strong>People</strong> collection, for a fresh list from the <strong>Business Object</strong>.<br />
<br />
<br />
For example, here is what we do&nbsp;for the <strong>Save</strong> command:<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">DoSave(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">param)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">UpdateBindingGroup.CommitEdit();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">var person = SelectedPerson
</code><code style="color:#006699;font-weight:bold;">as</code> <code style="color:#000000;">
PocoPerson;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(SelectedIndex == -1)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">personel.AddPerson(person);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RaisePropertyChanged(</code><code style="color:blue;">&quot;People&quot;</code><code style="color:#000000;">);
</code><code style="color:#008200;">// Update the list from the data source</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">else</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">personel.UpdatePerson(person);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">SelectedPerson =
</code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
CommitEdit updates the properties in the existing collection, if you are updating an existing Person.
<br />
It does not updating the list. CommitEdit will update the existing data and hence the user interface, so we don&#39;t need to request an update of the whole list.<br />
<br />
I hope this article has helped to explain the Role of PropertyChanged events in MVVM, and how to wire up your controls and navigation.<br />
<br />
<strong>Please&nbsp;give a couple of seconds, to rate/star the Gallery sample.</strong><br />
<br />
<br />
<strong style="font-size:13.63px;"><span style="font-size:14px;">DOWNLOAD :</span></strong><a href="http://gallery.technet.microsoft.com/Easy-MVVM-Examples-48c94de3" style="font-size:13.63px;"><span style="font-size:14px;"><strong>&nbsp;http://gallery.technet.microsoft.com/Easy-MVVM-Examples-48c94de3</strong></span></a><br />
<br />
<span style="color:#ff0000;"><br />
<strong><span style="font-size:14px;">Many more sample projects </span></strong><a href="http://code.msdn.microsoft.com/site/search?f%5B0%5D.Type=User&amp;f%5B0%5D.Value=XAML%20guy"><strong><span style="font-size:14px;">available HERE</span></strong></a><a href="http://code.msdn.microsoft.com/site/search?f%5B0%5D.Type=User&amp;f%5B0%5D.Value=XAML%20guy"><strong></strong></a><span style="font-size:14px;">!!!<br />
</span>&nbsp;<br />
&nbsp; <br />
<span style="color:#000000;"><strong>If you are learning MVVM, don&#39;t forget to grab
</strong><a href="http://social.technet.microsoft.com/wiki/contents/articles/13603.very-easy-mvvm.aspx"><strong><span style="font-size:14px;">this essential set of classes</span></strong></a><br />
</span></span>&nbsp;<br />
<p>â†‘ <a href="http://social.technet.microsoft.com/wiki/contents/articles/13536.easy-mvvm-examples-in-extreme-detail.aspx#Top">
<span style="color:#0066dd;">Return to Top</span></a></p>
<hr />
<a><img alt=" " src="http://c.statcounter.com/8287551/0/e9ab63ef/1/" style="border:currentcolor;" /></a>

</div>
    
    

    <!-- AUTO ADDED BELOW -->

    <div id='theFooter'></div>

    <script type='text/javascript'>
    
        var headerContainer = jQuery('#theHeader');
        jQuery.ajax({
            url: 'include/GitHubPagesWikiHeader.html',
            success: function (data) {
                headerContainer.html(data);
            }
        });

        var footerContainer = jQuery('#theFooter');
        jQuery.ajax({
            url: 'include/GitHubPagesWikiFooter.html',
            success: function (data) {
                footerContainer.html(data);
            }
        });       

    </script>
</body>

</html>