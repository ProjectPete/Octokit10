<html !DOCTYPE html>

<head>
    <script type='text/javascript' src='https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.5.2.min.js'></script>
    <link rel='stylesheet' type='text/css' href='include/LayoutMisc.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle2.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle3.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/DynamicStyle.css' xmlns='http://www.w3.org/1999/xhtml'>
</head>

<body style='margin:20px !important;'>

    <div id='theHeader'></div>

    <div id='theBreadcrumb'>
        <div class='breadcrumb-list'>
    <span class='breadcrumb-item'><a class='internal-link view-home' href='https://github.com/ProjectPete/Octokit10/tree/master/docs'>Wiki</a></span>

    <span class='separator'><span style='display:none;'></span>&nbsp;&gt;&nbsp;</span>
    <span class='breadcrumb-item'>
        <a href='/Octokit10/PageIndex1.html'>TechNet Articles</a>
    </span>

    <span class='breadcrumb-item'>
        <span class='separator'><span style='display:none;'></span>&nbsp;&gt;&nbsp;</span>
        <span class='breadcrumb-item'>
            <a href='https://github.com/ProjectPete/Octokit10/tree/master/docs/12387.how-to-concatenate-strings-into-a-single-wrapping-textblock-with-wrapping-on-each-word.html' class='last'>How to Concatenate Strings into a Single Wrapping TextBlock (with Wrapping on Each Word) - TechNet Articles - United States (English) - TechNet Wiki</a>
        </span>
    </span>
</div>

    </div>

    <div id='theOther'>
        <div class='content-fragment page-navigation no-wrapper' id='fragment-6614'>
    <div class='content-fragment-inner fiji-content-fragment-inner'>
        <div class='content-fragment-top fiji-content-fragment-top'><div class='r1 fiji-r1'></div><div class='r2 fiji-r2'></div><div class='r3 fiji-r3'></div><div class='r4 fiji-r4'></div></div><div class='content-fragment-content'>

            <div class='navigation-list-header'></div>
            <ul class='navigation-list'>

                <li class='navigation-item selected'>
                    <a class='internal-link view-wiki-page' href='#'>
                        <span></span>
                        Article
                    </a>
                </li>

                <li class='navigation-item'>
                    <a class='internal-link wiki-page-history' href='https://github.com/ProjectPete/Octokit10/commits/master/docs/12387.how-to-concatenate-strings-into-a-single-wrapping-textblock-with-wrapping-on-each-word.html'>
                        <span></span>
                        History
                    </a>
                </li>

            </ul>
            <div class='navigation-list-footer'></div>
        </div>
        <div class='content-fragment-footer'></div>
        <div class='content-fragment-bottom fiji-content-fragment-bottom'><div class='r1 fiji-r1'></div><div class='r2 fiji-r2'></div><div class='r3 fiji-r3'></div><div class='r4 fiji-r4'></div></div>
    </div>
</div>
    </div>

    <h1 class='post-name'>How to Concatenate Strings into a Single Wrapping TextBlock (with Wrapping on Each Word) - TechNet Articles - United States (English) - TechNet Wiki</h1>
            
    <!-- AUTO ADDED ABOVE -->

    <div class="post-content user-defined-markup">

<strong>This &quot;How To&quot; shows several concepts around grouping and wrapping text.</strong>
<br />
<br />
It also shows just how flexible the TextBlock now is, since the introduction of Runs. Each Run can have different styles, cursors, even events like MouseLeftButtonDown<br />
<br />
For this scenario, a WPF Forum poster wanted to know how to wrap blocks of text into one group, to make a single paragraph. This project shows two methods in four examples, the WrapPanel and TextBlock Runs. Both are useful concepts to understand, as they each
 have their uses.<br />
<br />
<p style="text-align:center;"><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2870.TextBlockRuns.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2870.TextBlockRuns.png" style="border-width:0px;border-style:solid;" /></a></p>
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2870.TextBlockRuns.png">
<div style="text-align:left;">&nbsp;</div>
</a>
<p>&nbsp;</p>
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2870.TextBlockRuns.png">
<div style="text-align:left;">&nbsp;</div>
</a><br />
<br />
<span style="font-size:medium;"><strong>1)</strong></span> Firstly an example of the WrapPanel, which is a great container, a very useful control:<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">WrapPanel</code>
<code style="color:#808080;">Margin</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;10&quot;</code><code style="color:#000000;">&gt;</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">TextBlock</code>
<code style="color:#808080;">Margin</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;0,0,4,0&quot;</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;This is an example&quot;</code><code style="color:#000000;">/&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">TextBlock</code>
<code style="color:#808080;">Margin</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;0,0,4,0&quot;</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;with textboxes that line up horizontally&quot;</code><code style="color:#000000;">/&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">TextBlock</code>
<code style="color:#808080;">Margin</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;0,0,4,0&quot;</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;then wrap by TEXTBLOCK to a new&quot;</code><code style="color:#000000;">/&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">TextBlock</code>
<code style="color:#808080;">Margin</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;0,0,4,0&quot;</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;line when there is no more space&quot;</code><code style="color:#000000;">/&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">TextBlock</code>
<code style="color:#808080;">Margin</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;0,0,4,0&quot;</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;pull the window out to&quot;</code><code style="color:#000000;">/&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">TextBlock</code>
<code style="color:#808080;">Margin</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;0,0,4,0&quot;</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;see it wrap and change&quot;</code><code style="color:#000000;">/&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">&lt;/</code><code style="color:#006699;font-weight:bold;">WrapPanel</code><code style="color:#000000;">&gt;</code></span></div>
</div>
<br />
<div class="endscriptcode">This will produce a bunch of textblocks that do not themselves wrap, and when there is no space, the TextBlock as a whole will jump to the next line.</div>
<div class="endscriptcode">&nbsp;</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><span style="font-size:medium;"><strong>2)</strong></span> Next here is an example of using the TextBlock.Inlines collection, by manually assigning Runs in XAML:</div>
<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">TextBlock</code>
<code style="color:#808080;">Margin</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;10&quot;</code>
<code style="color:#808080;">TextWrapping</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;Wrap&quot;</code><code style="color:#000000;">&gt;&lt;</code><code style="color:#006699;font-weight:bold;">Run</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;This is an example&quot;</code><code style="color:#000000;">/&gt;&lt;</code><code style="color:#006699;font-weight:bold;">Run</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot; of a group of&quot;</code><code style="color:#000000;">/&gt;&lt;</code><code style="color:#006699;font-weight:bold;">Run</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot; manually coded runs&quot;</code><code style="color:#000000;">/&gt;&lt;</code><code style="color:#006699;font-weight:bold;">Run</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot; which are parts of a textblock&quot;</code><code style="color:#000000;">/&gt;&lt;</code><code style="color:#006699;font-weight:bold;">Run</code>
<code style="color:#808080;">Text</code><code style="color:#000000;">=</code><code style="color:blue;">&quot; and this is probably closer to what you want&quot;</code><code style="color:#000000;">/&gt;&lt;/</code><code style="color:#006699;font-weight:bold;">TextBlock</code><code style="color:#000000;">&gt;</code></span></div>
</div>
<br />
<br />
This does just what we want, joining the blocks together and breaking on words, not per block.<br />
<br />
<div class="endscriptcode"><span style="font-size:medium;"><strong>3)</strong></span> Example three shows how to build the Runs programatically and add them to an existing TextBlock:</div>
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">var texts =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
List&lt;</code><code style="color:#006699;font-weight:bold;">string</code><code style="color:#000000;">&gt; {
</code><code style="color:blue;">&quot;This is an example of building a TextBlock&quot;</code><code style="color:#000000;">,
</code><code style="color:blue;">&quot; programmatically from a collection&quot;</code><code style="color:#000000;">,
</code><code style="color:blue;">&quot; of strings into one flexible wrapping TextBlock&quot;</code><code style="color:#000000;">};
</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">foreach</code>
<code style="color:#000000;">(var text </code><code style="color:#006699;font-weight:bold;">in</code>
<code style="color:#000000;">texts) </code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">tb1.Inlines.Add(</code><code style="color:#006699;font-weight:bold;">new</code>
<code style="color:#000000;">Run { Text = text });</code></span></span></div>
</div>
<br />
<span style="font-size:medium;"><strong><br />
4)</strong></span> Finally here is an example of some of the flexibility of this technique, by making two very different Runs which act independantly within a single TextBlock which I create and add to the Visual Tree.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">var cm1 =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
ContextMenu();</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">cm1.Items.Add(</code><code style="color:#006699;font-weight:bold;">new</code>
<code style="color:#000000;">MenuItem { Header = </code><code style="color:blue;">&quot;Copy&quot;</code>
<code style="color:#000000;">});</code></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">var cm2 =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
ContextMenu();</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">cm2.Items.Add(</code><code style="color:#006699;font-weight:bold;">new</code>
<code style="color:#000000;">MenuItem { Header = </code><code style="color:blue;">&quot;Do something else&quot;</code>
<code style="color:#000000;">});</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">var run1 =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
Run</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Text =
</code><code style="color:blue;">&quot;Hello&quot;</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Background = Brushes.Yellow,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Foreground = Brushes.Blue,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Cursor = Cursors.Hand,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">ContextMenu = cm1,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">FlowDirection = System.Windows.FlowDirection.RightToLeft,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">FontFamily =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
FontFamily(</code><code style="color:blue;">&quot;Courier&quot;</code><code style="color:#000000;">),</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">FontSize = 20.0D,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">FontWeight = FontWeights.Bold,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">TextDecorations = TextDecorations.Strikethrough,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">ToolTip =
</code><code style="color:blue;">&quot;Run 1&quot;</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">};</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">run1.MouseLeftButtonDown &#43;=
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
MouseButtonEventHandler(run1_MouseLeftButtonDown);</code></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">var run2 =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
Run</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Text =
</code><code style="color:blue;">&quot; World&quot;</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Background = Brushes.LightGreen,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Foreground = Brushes.Red,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Cursor = Cursors.Cross,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">ContextMenu = cm2,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">FlowDirection = System.Windows.FlowDirection.LeftToRight,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">FontFamily =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
FontFamily(</code><code style="color:blue;">&quot;Times New Roman&quot;</code><code style="color:#000000;">),</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">FontSize = 30.0D,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">FontWeight = FontWeights.ExtraLight,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">TextDecorations = TextDecorations.Underline,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">ToolTip =
</code><code style="color:blue;">&quot;Run 2&quot;</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">};</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">run2.MouseLeftButtonDown &#43;=
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
MouseButtonEventHandler(run2_MouseLeftButtonDown);</code></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">var tb2 =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
TextBlock { Margin = </code><code style="color:#006699;font-weight:bold;">new</code>
<code style="color:#000000;">Thickness(10) };</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">tb2.Inlines.Add(run1);</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">tb2.Inlines.Add(run2);</code></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">sp1.Children.Add(tb2);</code></span></div>
</div>
<br />
<br />
In this example, as well as the visual differences, you can hover over EACH TEXT PART and see a different Cursor &amp; Tooltip and even click each block to trigger separate events!<br />
<br />
<br />
This available in a&nbsp;<a href="http://code.msdn.microsoft.com/WpfHowTo-Concatinating-8dea4c0f"><strong>demo project here</strong></a>.
<br />
<br />
<br />
<em><strong>This small article is part of a </strong><a href="http://social.technet.microsoft.com/wiki/contents/articles/12346.wpfhowto-a-collection-of-helpful-short-articles.aspx"><strong>series of WPF &quot;How To&quot; articles</strong></a><strong>, in response to
 real user questions on the </strong></em><a href="http://social.msdn.microsoft.com/Forums/en/wpf"><em><span style="color:#0066dd;"><strong>MSDN WPF Forum</strong></span></em></a><em><strong>.</strong></em>
<br />
<br />
<ul>
<li><a href="http://social.msdn.microsoft.com/Forums/en/wpf/thread/1b556c67-3920-4bf4-8d11-2adc723c39e1">Link to original MSDN WPF Forum Question</a>
</li></ul>
<p>&nbsp;</p>

</div>
    
    

    <!-- AUTO ADDED BELOW -->

    <div id='theFooter'></div>

    <script type='text/javascript'>
    
        var headerContainer = jQuery('#theHeader');
        jQuery.ajax({
            url: 'include/GitHubPagesWikiHeader.html',
            success: function (data) {
                headerContainer.html(data);
            }
        });

        var footerContainer = jQuery('#theFooter');
        jQuery.ajax({
            url: 'include/GitHubPagesWikiFooter.html',
            success: function (data) {
                footerContainer.html(data);
            }
        });       

    </script>
</body>

</html>