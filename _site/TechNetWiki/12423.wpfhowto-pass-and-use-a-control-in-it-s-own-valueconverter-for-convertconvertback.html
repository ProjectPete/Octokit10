<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="stylesheet" href="/Octokit10/css/site.css">
    <link rel="stylesheet" href="/Octokit10/css/syntax.css">

    <link rel="stylesheet" href="/Octokit10/css/jquery.rateyo.css">

    <link rel='stylesheet' type='text/css' href='/Octokit10/css/LayoutMisc.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='/Octokit10/css/ReducedStyle.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='/Octokit10/css/ReducedStyle2.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='/Octokit10/css/ReducedStyle3.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='/Octokit10/css/DynamicStyle.css' xmlns='http://www.w3.org/1999/xhtml'>


    <title>TechNet Wikiii</title>

    <!-- This is _includes header -->

</head>

<body style='margin:20px !important;'>

    Hello 

    <div class="header-fragments" role="banner">

        <div class="header-fragment-outer fiji-header-fragment-outer site-banner">
            <div class="header-fragment-inner fiji-header-fragment-inner site-banner">
                <ul class="navigation" role="navigation">
                    <li class="nav-home"><a href="http://technet.microsoft.com/en-us/default.aspx">Home</a></li>
                    <li class="nav-library"><a href="http://technet.microsoft.com/library/en-us/default.aspx">Library</a></li>
                    <li class="nav-wiki"><a href="http://social.technet.microsoft.com/wiki/">Wiki</a></li>
                    <li class="nav-learn"><a href="http://technet.microsoft.com/en-us/bb291022.aspx">Learn</a></li>
                    <li class="nav-gallery"><a href="http://gallery.technet.microsoft.com/en-us/">Gallery</a></li>
                    <li class="nav-downloads"><a href="http://technet.microsoft.com/en-us/bb403698.aspx">Downloads</a></li>
                    <li class="nav-support"><a href="http://technet.microsoft.com/en-us/ms772425.aspx">Support</a></li>
                    <li class="nav-forums"><a href="http://social.technet.microsoft.com/Forums/en-us/">Forums</a></li>
                    <li class="nav-blogs"><a href="http://blogs.technet.com/">Blogs</a></li>
                </ul>
                <span class="IT_Resources">Resources For IT Professionals</span>
                <div class="header-fragment site-banner" id="header-fragment-668884186">

                    <div class="site-banner-header">
                    </div>
                    <div class="site-banner">

                        <div class="site-logo">
                            <a href="http://technet.microsoft.com/default.aspx" aria-label="Microsoft Technet">
                                <img src="https://social.technet.microsoft.com/wiki/themes/TechNetmetro/images/tn-logo-wiki.png" alt="Microsoft Technet Image" style="border-width:0px;">
                            </a>
                        </div>

                    </div>
                    <div id="LanguageAndCustomize">
                        <span class="localeFlyout">
                            <script src="https://i1.social.s-msft.com/wiki/rrcontent/b108147f1506a70eaa0a54d930eed5b2-a023bc3badb979ad686bdc2e246437a8-RequestReducedScript.js" type="text/javascript"></script>
                            <div class="LocaleFlyout" id="LocaleFlyout">
                                <div id="LocaleSelector">
                                    <div id="TargetPanel">
                                        <a tabindex="0">United Kingdom (Proper English-like)</a>
                                        <!--<img class="DropDownArrow" tabindex="0" aria-label="Drop down arrow" alt="Drop down arrow" src="https://social.technet.microsoft.com/wiki/themes/TechNetmetro/images/DropDownArrow_Gray.png">-->
                                    </div>
                                </div>
                            </div>
                        </span>

                    </div>
                    <a class="screen-reader-shortcut" href="#LanguageAndCustomize">Skip to locale bar</a>
                    <div class="site-banner-footer">
                    </div>
                </div>
            </div>
        </div>

        <div class="header-fragment-outer fiji-header-fragment-outer search">
            <div class="header-fragment-inner fiji-header-fragment-inner search">
                <div class="header-fragment search" id="header-fragment-668884187">

                    <div class="field-list-header">
                    </div>
                    <fieldset class="field-list">
                        <ul class="field-list">
                            <li class="field-item">
                                <span class="field-item-input">
                                    <p role="alert" style="height: 1px;width: 1px;overflow: hidden;position: absolute;"></p>
                                    <input id="Header_SearchTextBox" name="Header_SearchTextBox" type="text" class="search empty" autocomplete="off" data-searchtype="searchbox" role="combobox" aria-label="Search Input Box" aria-autocomplete="both" aria-owns="MSDNSearchAutoCompleteList" aria-live="polite" placeholder="Search TechNet with Bing" title="Search TechNet with Bing">
                                    <input id="Header_SearchButton" name="Header_SearchButton" type="image" class="search-button" src="https://social.technet.microsoft.com/wiki/themes/TechNetMetro/Images/bingSearch.png" data-searchtype="icon" title="Search TechNet with Bing">
                                    <div id="SearchFlyoutContainer" style="display: none; text-align: left; border: 1px solid buttonshadow; position: absolute; z-index: 1000; padding: 2px; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 14px;"><div id="SuggestionContainer"><ul data-searchtype="search dropdown" id="MSDNSearchAutoCompleteList" role="listbox" aria-controls="Header_SearchTextBox" style="list-style: none; padding: 4px 2px 0px 1px; cursor: pointer; margin: 1px; white-space: nowrap;"></ul></div></div>
                                </span>
                            </li>
                            <li id="ctl00_ctl00_header_fragment_668884187__ffffffffc94374ed_ctl00_SearchOptionsButtonWrapper" class="field-item">
                                <span class="field-item-input">
                                    <a class="internal-link search-options" title="Change Search Scope">&nbsp;</a>
                                </span>
                            </li>
                        </ul>
                    </fieldset>
                    <div class="field-list-footer">

                        <script type='text/javascript' src='/Octokit/js/jquery.min.js'></script>
                        <script src="/Octokit/js/jquery.rateyo.js"></script>

                    </div>
                    <script src="https://i4.services.social.microsoft.com/Search/Widgets/SearchBox.jss?boxid=Header_SearchTextBox&amp;btnid=Header_SearchButton&amp;brand=Technet&amp;refinement=90&amp;resref=&amp;addEnglish=&amp;rn=&amp;rq=&amp;watermark=&amp;focusOnInit=false&amp;beta=0&amp;iroot=&amp;overrideWatermark=false&amp;loc=en-US" type="text/javascript" language="javascript"></script>
                    <script type="text/javascript">
                        // JSLL Record
                        var scriptJSLL = document.createElement("script");
                        scriptJSLL.type = "text/javascript";
                        scriptJSLL.src = "/js/jsll-4.2.1.js";
                        scriptJSLL.onload = function () {
                            var config = {
                                coreData: {
                                    appId: "socialtechnet"
                                }
                            };
                            awa.init(config);
                        };
                        if (document.getElementsByTagName("head") && document.getElementsByTagName("head").length > 0) {
                            document.getElementsByTagName("head")[0].appendChild(scriptJSLL);
                        }
                    </script>
                    <script type="text/javascript">
                        var textbox = document.getElementById("Header_SearchTextBox");
                        textbox.onkeypress = function (event) {
                            var n = window.mscc;
                            n && !n.hasConsent() && n.setConsent();
                        }
                    </script>
                </div>
            </div>
        </div>
    </div>

    <div class='breadcrumb-list'>
        <span class='breadcrumb-item'><a class='internal-link view-home' href='https://github.com/technet2/Wiki/tree/master/docs'>Wiki</a></span>

        <span class='separator'><span style='display:none;'></span>&nbsp;&gt;&nbsp;</span>
        <span class='breadcrumb-item'>
            <a href='/Wiki/articles/PageIndex1.html'>TechNet Articles</a>
        </span>

        <span class='breadcrumb-item'>
            <span class='separator'><span style='display:none;'></span>&nbsp;&gt;&nbsp;</span>
            <span id="editMeCrumb" class='breadcrumb-item'>
                <!--<a href='https://github.com/technet2/Wiki/tree/master/docs/#file' class='last'>Edit this page here</a>-->
            </span>
        </span>
    </div>

    <div class='content-fragment page-navigation no-wrapper' id='fragment-6614'>
        <div class='content-fragment-inner fiji-content-fragment-inner'>
            <div class='content-fragment-top fiji-content-fragment-top'><div class='r1 fiji-r1'></div><div class='r2 fiji-r2'></div><div class='r3 fiji-r3'></div><div class='r4 fiji-r4'></div></div><div class='content-fragment-content'>

                <div class='navigation-list-header'></div>
                <ul class='navigation-list'>

                    <li class='navigation-item selected'>
                        <a class='internal-link view-wiki-page' href='#'>
                            <span></span>
                            Article
                        </a>
                    </li>

                    <li class='navigation-item'>
                        <a id="myHistory" class='internal-link wiki-page-history' href='#'>
                            <span></span>
                            History
                        </a>

                        <div style="margin-top:-30px; margin-left:80px"><div id="rateYo"></div></div>
                    </li>
                </ul>
                <div class='navigation-list-footer'></div>
            </div>
            <div class='content-fragment-footer'></div>
            <div class='content-fragment-bottom fiji-content-fragment-bottom'><div class='r1 fiji-r1'></div><div class='r2 fiji-r2'></div><div class='r3 fiji-r3'></div><div class='r4 fiji-r4'></div></div>
        </div>
    </div>

    <div id='theHeader'></div>

    <!-- This is _includes header -->
    <!-- AUTO ADDED ABOVE -->


<!-- default layout -->

<h1></h1>


<br><br>A common question on the WPF forums is how to pass the control itself into a ValueConverter that is acting on one of it's properties.<br>  
  
<br>This example shows how that is achieved with three examples.  
<br>   
<br>The main trick here is to use a **MultiValueConverter** and a **<br>MultiBinding,**but where it is defined in resources is very important.  
  

### **Example 1**


The first example passes in a bound value from the code-behind and the control itself through a MultiBinding, to the MultiValueConverter. <br>

  

<TextBlockx:Name="tb1"Margin="20">

    <TextBlock.Text>

        <MultiBindingConverter="{StaticResource MyConverter}">

            <BindingRelativeSource="{RelativeSource Self}"/>

            <BindingPath="MyValue"/>

        </MultiBinding>

    </TextBlock.Text>

</TextBlock>
  
  


The main thing to note here is the RelativeSource of the first binding, being {RelativeSource Self}.<br>  
<br>This will pass the control itself into the converter.



Here is the converter:


publicclass MyConverter : IMultiValueConverter

{

    FrameworkElement myControl;

    objecttheValue;



    publicobject Convert(object[] values, System.Type targetType,object parameter, System.Globalization.CultureInfo culture)

    {

        myControl = values[0]as FrameworkElement;

        theValue = values[1];



        returnmyControl.Name +" : "+ values[1];

    }



    publicobject[] ConvertBack(objectvalue, System.Type[] targetTypes,objectparameter, System.Globalization.CultureInfo culture)

    {

        returnnew object[] {null, myControl.Name +" : " + theValue };

    }

}
  
  
<br>The Convert method just takes the first value and converts it into a [<br>FrameworkElement](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.aspx), so it can take the control's name (proving the control was passed in correctly) which it joins to the second parameter. It also keeps a local copy of the values for the ConvertBack method discussed later in example 3.<br>





**Notice the values array in MultiValueConverters order the bidings by the same order they are shown in the markup code.**


### **Example 2**


The second example is similar in that it sets a property of UserControl1, but this example includes a couple of extras.



Firstly you will notice the [**DependancyPropertyChangedCallback**](http://msdn.microsoft.com/en-us/library/ms745795.aspx) parameter of the<br>[<br>DependancyProperty](http://msdn.microsoft.com/en-us/library/system.windows.dependencyproperty.aspx) constructor is used. Any changes to the MyUserControlvalue property will cause a call to MyUserControlValueChanged. In the example, this method takes the new value (e.NewValue) and adds it to a datestamp into the third textbox of UserControl1.  
<br>Also notice the control itself was passed in, this is where you can act on the specific object instance.






publicstatic readonly DependencyProperty MyUserControlValueProperty =

    DependencyProperty.Register("MyUserControlValue",typeof(string),typeof(UserControl1),new UIPropertyMetadata(null, MyUserControlValueChanged));



staticvoid MyUserControlValueChanged(DependencyObject dp, DependencyPropertyChangedEventArgs e)

{

    var uc1 = dpas UserControl1;

    uc1.MyChangedDateString = e.NewValue +" - " + DateTime.Now.ToString();

}


This user control is used just the same as the previous example:This user control is used just the same as the previous example:This user control is used just the same as the previous example:


<local:UserControl1 x:Name="uc1"Background="Yellow">

    <local:UserControl1.MyUserControlValue>

        <MultiBinding Converter="{StaticResource MyConverter2}">

            <Binding RelativeSource="{RelativeSource Self}"/>

            <Binding Path="MyValue"/>

        </MultiBinding>

    </local:UserControl1.MyUserControlValue>

</local:UserControl1>


However the converter in this example shows how once you have the control, the converter can safely do stuff on it like calling it's methods.


publicclass MyConverter2 : IMultiValueConverter

{

    publicobject Convert(object[] values, System.Type targetType,object parameter, System.Globalization.CultureInfo culture)

    {

        var uc = values[0]as UserControl1;

        uc.MyShowTextMethod("Set from converter");



        returnuc.Name +" : "+ values[1];

    }



    publicobject[] ConvertBack(objectvalue, System.Type[] targetTypes,objectparameter, System.Globalization.CultureInfo culture)

    {

        thrownew System.NotImplementedException();

    }

}





### **Example 3**


This is in response to a [<br>follow-up question](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/e47ef158-d1e1-40b7-991d-3b4970d2123e) where the poster wanted to use the passed in control in the ConvertBack method. As shown above, the passed in values are kept for use with the ConvertBack method.



**It is important to understand how and WHERE you refer to the Converter, not as one StaticResource, but as several localised resources.** If it is defined in the top Window/Page level resources, all controls will use the same converter instance,<br> so any passed in values will be written over by the next control. When you try to convert back, you will get whatever the last control to use Convert was.



Instead, you have to define the static resource at CONTROL LEVEL, so only that control uses THAT instance of the converter.**This is an important concept to know.**


<TextBox x:Name="tb1"Margin="20">

    <TextBox.Resources>

        <local:MyConverter x:Key="MyConverter"/>

    </TextBox.Resources>

    <TextBox.Text>

        <MultiBinding Converter="{StaticResource MyConverter}"UpdateSourceTrigger="PropertyChanged">

            <Binding RelativeSource="{RelativeSource Self}"Mode="OneTime"/>

            <Binding Path="MyValue"/>

        </MultiBinding>

    </TextBox.Text>

</TextBox>



<TextBox x:Name="tb2"Margin="20">

    <TextBox.Resources>

        <local:MyConverter x:Key="MyConverter"/>

    </TextBox.Resources>

    <TextBox.Text>

        <MultiBinding Converter="{StaticResource MyConverter}"UpdateSourceTrigger="PropertyChanged">

            <Binding RelativeSource="{RelativeSource Self}"Mode="OneTime"/>

            <Binding Path="MyValue2"/>

        </MultiBinding>

    </TextBox.Text>

</TextBox>
  
  
<br>This available in a [**demo project here**](http://code.msdn.microsoft.com/WPF-Parsing-XAML-into-440bdfed).<br>  
  
  
***This small article is part of a**[**series of WPF "How To" articles**](http://social.technet.microsoft.com/wiki/contents/articles/12346.wpfhowto-a-collection-of-helpful-short-articles.aspx)**, in response to<br> real user questions on the***[***MSDN WPF Forum***](http://social.msdn.microsoft.com/Forums/en/wpf)***.***  
  

- [Link to original MSDN WPF Forum Question](http://social.msdn.microsoft.com/Forums/en/wpf/thread/c2b3b414-170d-41e4-9c98-b4164c2754ae)


<!-- default layout -->

<!-- AUTO ADDED BELOW -->

<footer>
    <!-- This is _includes footer.html -->
    <script>
        var currentMousePos = { x: -1, y: -1 };

        $(document).ready(function () {
            $(document).mousemove(function (event) {
                currentMousePos.x = event.pageX;
                currentMousePos.y = event.pageY;
            });

            var args = document.location.href.match(/[^\/]+$/);
            var fileName = '';
            if (!args || args.length == 0) {
                return;
            }

            fileName = args[0];
            var infoFile = fileName.replace(".html", ".json");

            var fileInfo = "https://raw.githubusercontent.com/technet2/Wiki/master/docs/info/" + infoFile;
            var editVersion = "https://github.com/technet2/Wiki/blob/master/docs/articles/" + fileName;
            var historyVersion = "https://github.com/technet2/Wiki/commits/master/docs/articles/" + fileName;

            var $h1 = document.querySelector('h1');
            if ($h1) {
                title = $h1.innerText;
                $('#editMeCrumb').append($('<a href="' + editVersion + '">' + title + '!!!</a>'));
            }

            var url = "https://github.com/technet2/Wiki/commits/master/docs/articles/" + fileName;
            var $tab = document.querySelector('#myHistory');
            $tab.setAttribute('href', url);
            //$('#myHistory').setAttribute('href', url);

            $.getJSON(fileInfo, function (data) {
                var keyPhrases = [];
                $.each(data.KeyPhrases, function (key, val) {
                    keyPhrases.push("<span class=\"phr\" onclick=\"clickedPhrase('" + val.SafeName + "\')\">" + val.Name + "</span>&nbsp;|&nbsp;");
                });

                var netities = [];

                $.each(data.Netities, function (key, val) {
                    var name = val.Name;
                    var type = "";
                    if (val.Type) {
                        type += "" + val.Type;
                    }
                    if (val.SubType) {
                        type += ", " + val.SubType;
                    }
                    if (type != "") {
                        name += " (" + type + ")";
                    }
                    if (val.WikipediaUrl) {
                        netities.push("<a href='" + val.WikipediaUrl + "'>" + name + "</a>&nbsp;|&nbsp;");
                    }
                    else {
                        netities.push(name + "&nbsp;|&nbsp;");
                    }
                });

                if (keyPhrases.length > 0) {
                    $("<h2>Key Phrases Identified</h2>").appendTo("#tags");

                    $("<ul/>", {
                        "class": "tag-list",
                        html: keyPhrases.join("")
                    }).appendTo("#tags");
                }

                if (netities.length > 0) {
                    $("<h2>Entities on Wikipedia</h2>").appendTo("#tags");

                    $("<ul/>", {
                        "class": "tag-list",
                        html: netities.join("")
                    }).appendTo("#tags");
                }
            }).error(function () { console.log('No info file found for this page'); });

        });

        function goToIndex(file) {
            file = 'https://github.com/technet2/Wiki/blob/master/docs/index/' + file;
            console.log(file);
            window.location.href = file;
        }

        function goToSubIndex(file) {
            console.log(file);
            window.location.href = file;
        }

        function clickedPhrase(safeName) {
            //console.log(ele.innerText);
            var popup = $('#tagPopup');
            var tagList = $('#tagList');
            tagList.empty();

            var fileInfo = "https://raw.githubusercontent.com/technet2/Wiki/master/docs/index/" + safeName + ".json";

            $.getJSON(fileInfo, function (data) {
                var nextLinks = [];

                popup.css('visibility', 'visible');
                popup.css('left', currentMousePos.x);
                popup.css('top', currentMousePos.y);

                $.each(data.Refs, function (key, val) {
                    nextLinks.push("<div style='margin-bottom:8px;'><a href='/Wiki/articles/" + val.FileName + "'>" + val.Title + "</a></div>");
                });

                $("<div/>", {
                    "class": "link-list",
                    html: nextLinks.join("")
                }).appendTo("#tagList");
            });

        }

        $(function () {

            $("#rateYo").rateYo({

                onSet: function (rating, rateYoInstance) {

                    alert("Rating is set to: " + rating);
                }
            });
        });
    </script>

    <!--<script src="/js/site.js"></script>-->

    <div id="tags"></div>

    <div class="footer-fragments" role="contentinfo">
        <div class="footer-fragment copyright-info" id="footer-fragment-668884183">

            <ul class="footer-fragment-links">
                <li class="message copyright">C 2015 Microsoft Corporation. All rights reserved.</li>
                <li class="message termsOfService"><a href="http://technet.microsoft.com/cc300389">Terms of Use</a> </li>
                <li class="message trademarks"><a href="http://www.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx">Trademarks</a> </li>
                <li class="message privacy"><a href="http://go.microsoft.com/fwlink/?LinkId=248681">Privacy Statement</a> </li>
                <li class="message version">[Copied from] v5.6.915.0</li>
                <img tabindex="0" style="float: right;" aria-label="Microsoft" src="https://social.technet.microsoft.com/wiki/themes/TechNetMetro/images/technet/microsoft.gif">
            </ul>

            <ul class="footer-fragment-links" style="margin-top:5px !important;">
                <li>This page has been extacted by Pete Laker, <a href="https://mvp.microsoft.com/en-us/PublicProfile/5001916">Microsoft Azure MVP</a> &amp; <a href="https://www.microsoft.com/en-gb/atwork/it-implementer/">Microsoft IT Implementer</a></li>
            </ul>
        </div>

        <style>
            .phr {
                color: cornflowerblue;
            }

                .phr:hover {
                    font-weight: bold;
                    color: blue;
                    cursor: pointer;
                }
        </style>

        <div class="footer-fragment app-insights-footer-fragment" id="footer-fragment-668884184">

            <!--<span class='phr' onclick='clickedPhrase(this)'>API</span>&nbsp;|&nbsp;-->

        </div>

        <div id="tagPopup" style="background-color:#f5f3f3; visibility:hidden; position:absolute; margin:20px; border:1px solid #000000; display:block; padding:2px;">
            <span style="position:absolute; right:0; top:0; margin:2px; width:10px; height:10px; font-size:x-small; background-color:red; color:white; font-weight:bold; border:1px solid #808080; display:block; padding:2px; cursor:pointer" onclick="$('#tagPopup').css('visibility', 'hidden')">X</span>
            <div id="tagList" style="margin:5px; margin-right:15px; font-size:x-small"></div>
        </div>


    </div>
</footer>

<!-- This is _includes footer.html -->
</body>

</html>